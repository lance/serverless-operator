apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  annotations:
    operator.tekton.dev/last-applied-hash: 8353dd6bb4f36239f16fe4449f0f3442d2a045c975bc87d99481cc8bc780b636
    operator.tekton.dev/preserve-namespace: 'true'
  resourceVersion: '98767'
  name: s2i-nodejs
  uid: fa7c2f60-7665-4010-8f12-1bd2d060ae56
  creationTimestamp: '2023-04-05T06:08:15Z'
  generation: 1
  managedFields:
    - apiVersion: tekton.dev/v1beta1
      fieldsType: FieldsV1
      fieldsV1:
        'f:metadata':
          'f:annotations':
            .: {}
            'f:operator.tekton.dev/last-applied-hash': {}
            'f:operator.tekton.dev/preserve-namespace': {}
          'f:labels':
            .: {}
            'f:operator.tekton.dev/operand-name': {}
            'f:pipeline.openshift.io/runtime': {}
            'f:pipeline.openshift.io/type': {}
          'f:ownerReferences':
            .: {}
            'k:{"uid":"8862e0b3-9e29-45d6-be0d-e656b05573de"}': {}
        'f:spec':
          .: {}
          'f:params': {}
          'f:tasks': {}
          'f:workspaces': {}
      manager: manifestival
      operation: Update
      time: '2023-04-05T06:08:15Z'
  namespace: openshift
  ownerReferences:
    - apiVersion: operator.tekton.dev/v1alpha1
      blockOwnerDeletion: true
      controller: true
      kind: TektonInstallerSet
      name: addon-custom-pipelinestemplate-b7cfb
      uid: 8862e0b3-9e29-45d6-be0d-e656b05573de
  labels:
    operator.tekton.dev/operand-name: openshift-pipelines-addons
    pipeline.openshift.io/runtime: nodejs
    pipeline.openshift.io/type: openshift
spec:
  params:
    - name: APP_NAME
      type: string
    - name: GIT_REPO
      type: string
    - name: GIT_REVISION
      type: string
    - name: IMAGE_NAME
      type: string
    - default: .
      name: PATH_CONTEXT
      type: string
    - default: 14-ubi8
      name: VERSION
      type: string
  tasks:
    - name: fetch-repository
      params:
        - name: url
          value: $(params.GIT_REPO)
        - name: revision
          value: $(params.GIT_REVISION)
        - name: subdirectory
          value: ''
        - name: deleteExisting
          value: 'true'
      taskRef:
        kind: ClusterTask
        name: git-clone
      workspaces:
        - name: output
          workspace: workspace
    - name: build
      params:
        - name: IMAGE
          value: $(params.IMAGE_NAME)
        - name: TLSVERIFY
          value: 'false'
        - name: PATH_CONTEXT
          value: $(params.PATH_CONTEXT)
        - name: VERSION
          value: $(params.VERSION)
      runAfter:
        - fetch-repository
      taskRef:
        kind: ClusterTask
        name: s2i-nodejs
      workspaces:
        - name: source
          workspace: workspace
    - name: deploy
      params:
        - name: SCRIPT
          value: oc rollout status dc/$(params.APP_NAME)
      runAfter:
        - build
      taskRef:
        kind: ClusterTask
        name: openshift-client
  workspaces:
    - name: workspace
